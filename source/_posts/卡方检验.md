---
title: 卡方检验
date: 2018-04-01 20:24:15
tags: 统计学基础
---
[markdown数学公式基础](https://blog.csdn.net/zdk930519/article/details/54137476)



#### 卡方分布的定义

若$k$个随机变量$Z\_1$,...,$Z\_k$满足标准的正太分布$N(0,1)$,则：
$$X=\sum_{i=1}^k Z_i$$
那么$X$服从$\\chi$分布，记为

$$X~\\chi^2(k)$$

其期望和方差分别为：

$$E(\\chi^2)=n$$

$$D(\\chi^2)=2n$$
其中$n$为卡方分布的自由度

#### 卡方检验

卡方检验主要以卡方分布为基础，主要用于判断变量之间是否相关。
一般原假设$H\_0$可以是：假设变量之间是相互独立的，或者之间的关系是不显著的。
因此在原假设正确的前提下，可以计算卡方值，也就是实际的和理论的偏差有多少。计算公式如下：

$$\chi^2=\sum \frac{(T-A)^2}{T}$$

其中T为理论值，A为实际值

$\chi^2$用于衡量实际值与理论值的差异程度，这也是卡方检验的核心思想。$\chi^2$包含了以下两个信息：
1.实际值与理论值偏差的绝对大小。
2.差异程度与理论值的相对大小。

#### 卡方检验做特征选择
 可以举个例子如下：
 比如我们有一堆分好类别的文本，我们要判断某个词是否属于这个类别，或者说词和类别之间是否独立，我们可以使用卡方检验来做特征选择，选取值比较大的，可以认为是显著相关的。因此我们需要统计下面这个表格：

  | 类别B | 非类别B | 统计
- | :-: |  -
  包含词A  |  50  |  5 | 55
  不包含词A  |  10  |  40 | 50
  统计  |  60  |  45 | 105

首先基于前面的介绍，原假设是词A和类别B之间是独立的
因此随机取一个一个文本，这个文本属于这个类别B的概率就是：(50+10)/105=0.57

因此在假设成立的情况下有：

  | 类别B | 非类别B | 统计
- | :-: |  -
  包含词A  |  55×0.57=31  |  55-31=24 | 55
  不包含词A  |  50×0.57=29  |  50-29=21 | 50
  统计  |  60  |  45 | 105

可以看出，如果词A和类别B独立，则这两个表应该很相近，因此我们计算其卡方值有：
$$\chi^2=\frac{(50-31)^2}{31} + \frac{(5-24)^2}{24} + \frac{(10-29)^2}{29} + \frac{(40-21)^2}{21}$$

**因此我们可以就算每个词和每个类别的卡方值，选择其中值比较大的作为其特征，也就是显著与原假设不符的，也即不独立，是相关的。设置阈值。**

对于四表格$\\chi^2$的值可以使用如下公式计算：

| 类别B | 非类别B | 统计
- | :-: |  -
包含词A  |  A |  B | A+B
不包含词A  |  C  | D | C+D
统计  |  A+C  |  B+D | A+B+C+D

$$\chi^2=\frac{N*(AD-BC)^2}{(A+B)(C+D)(A+C)(B+D)}$$

推导如下：
$$\chi^2=\frac{(A-p(A+B))^2}{p(A+B)} + \frac{(B-(1-p)(A+B))^2}{(1-p)(A+B)} + $$
$$ \frac{(C-p(C+D))^2}{p(C+D)} + \frac{(D-(1-p)(C+D))^2}{(1-p)(C+D)}$$ $$=\frac{N*(AD-BC)^2}{(A+B)(C+D)(A+C)(B+D)}$$
